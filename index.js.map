{"version":3,"file":"index.js","sources":["../src/js/2-pixabay-api.js","../src/js/1-gallery.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '53367958-e4d72e9b7abbbffbba381cf2e';\nconst BASE_URL = 'https://pixabay.com/api/';\nexport const PER_PAGE = 15;\n\nconst instance = axios.create({\n    baseURL: BASE_URL,\n    timeout: 10000,\n});\n\nexport async function getImagesByQuery(query, page = 1) {\n    try {\n        const response = await instance.get('/', {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                per_page: PER_PAGE,\n                page,\n            },\n        });\n        return response.data;\n    } catch (error) {\n        throw error;\n    }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n    gallery: document.querySelector('.js-gallery'),\n    loader: document.getElementById('loader'),\n    loadMoreBtn: document.getElementById('load-more'),\n};\n\nconst lightbox = new SimpleLightbox('.js-gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\n\nfunction createCard({\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n}) {\n    return `<li class=\"gallery-item\">\n    <a href=\"${largeImageURL}\" class=\"gallery-link\">\n      <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n    </a>\n    <div class=\"gallery-descr\">\n      <div class=\"gallery-descr-item\">\n        <p class=\"gallery-descr-title\">Likes</p>\n        <p class=\"gallery-descr-value\">${likes}</p>\n      </div>\n      <div class=\"gallery-descr-item\">\n        <p class=\"gallery-descr-title\">Views</p>\n        <p class=\"gallery-descr-value\">${views}</p>\n      </div>\n      <div class=\"gallery-descr-item\">\n        <p class=\"gallery-descr-title\">Comments</p>\n        <p class=\"gallery-descr-value\">${comments}</p>\n      </div>\n      <div class=\"gallery-descr-item\">\n        <p class=\"gallery-descr-title\">Downloads</p>\n        <p class=\"gallery-descr-value\">${downloads}</p>\n      </div>\n    </div>\n  </li>`;\n}\n\nexport function createGallery(images) {\n    if (!Array.isArray(images) || images.length === 0) return;\n    const markup = images.map(createCard).join('');\n    refs.gallery.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n}\n\n\nexport function clearGallery() {\n    refs.gallery.innerHTML = '';\n    lightbox.refresh();\n}\n\n\nexport function showLoader() {\n    refs.loader.classList.remove('is-hidden');\n}\nexport function hideLoader() {\n    refs.loader.classList.add('is-hidden');\n}\n\nexport function showLoadMoreButton() {\n    refs.loadMoreBtn.classList.remove('is-hidden');\n}\nexport function hideLoadMoreButton() {\n    refs.loadMoreBtn.classList.add('is-hidden');\n}\n\n\nexport const galleryRef = refs.gallery;\nexport const loadMoreBtnRef = refs.loadMoreBtn;\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getImagesByQuery, PER_PAGE } from './js/2-pixabay-api.js';\nimport {\n    clearGallery,\n    createGallery,\n    showLoader,\n    hideLoader,\n    showLoadMoreButton,\n    hideLoadMoreButton,\n    loadMoreBtnRef,\n    galleryRef,\n} from './js/1-gallery.js';\n\nconst form = document.getElementById('search-form');\nconst input = form.querySelector('input[name=\"search-text\"]');\n\nlet currentQuery = '';\nlet page = 1;\nlet totalHits = 0;\n\nform.addEventListener('submit', onSearch);\nloadMoreBtnRef.addEventListener('click', onLoadMore);\n\nfunction notifyInfo(message) {\n    iziToast.info({ title: '', message, position: 'topRight' });\n}\nfunction notifySuccess(message) {\n    iziToast.success({ title: '', message, position: 'topRight' });\n}\nfunction notifyError(message) {\n    iziToast.error({ title: 'Error', message, position: 'topRight' });\n}\n\nasync function onSearch(e) {\n    e.preventDefault();\n    const query = input.value.trim();\n    if (!query) {\n        notifyInfo('Please enter a search query.');\n        return;\n    }\n\n\n    if (query !== currentQuery) {\n        currentQuery = query;\n        page = 1;\n        totalHits = 0;\n        clearGallery();\n        hideLoadMoreButton();\n    }\n\n    await fetchAndRender();\n    form.reset();\n}\n\nasync function onLoadMore() {\n    await fetchAndRender();\n}\n\nasync function fetchAndRender() {\n    try {\n        showLoader();\n\n        const data = await getImagesByQuery(currentQuery, page);\n        if (!data || !Array.isArray(data.hits)) {\n            notifyError('Немає відповіді від сервера.');\n            return;\n        }\n\n        const { hits, totalHits: total } = data;\n\n\n        if (page === 1 && hits.length === 0) {\n            hideLoadMoreButton();\n            notifyInfo(\n                'Sorry, there are no images matching your search query. Please try again!'\n            );\n            return;\n        }\n\n\n        createGallery(hits);\n\n\n        totalHits = total;\n\n\n        const imagesAlreadyShown = (page - 1) * PER_PAGE + hits.length;\n\n        if (imagesAlreadyShown < totalHits) {\n            showLoadMoreButton();\n        } else {\n            hideLoadMoreButton();\n            notifyInfo(\"We're sorry, but you've reached the end of search results.\");\n        }\n\n\n        if (page > 1) {\n            smoothScrollAfterLoad();\n        }\n\n        page += 1;\n    } catch (error) {\n        notifyError('Something went wrong. Please try again later.');\n        console.error(error);\n    } finally {\n        hideLoader();\n    }\n}\n\nfunction smoothScrollAfterLoad() {\n    const firstCard = galleryRef.querySelector('.gallery-item');\n    if (!firstCard) return;\n    const { height } = firstCard.getBoundingClientRect();\n    window.scrollBy({\n        top: height * 2,\n        behavior: 'smooth',\n    });\n}\n"],"names":["API_KEY","BASE_URL","PER_PAGE","instance","axios","getImagesByQuery","query","page","error","refs","lightbox","SimpleLightbox","createCard","webformatURL","largeImageURL","tags","likes","views","comments","downloads","createGallery","images","markup","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","galleryRef","loadMoreBtnRef","form","input","currentQuery","totalHits","onSearch","onLoadMore","notifyInfo","message","iziToast","notifyError","fetchAndRender","data","hits","total","smoothScrollAfterLoad","firstCard","height"],"mappings":"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"}